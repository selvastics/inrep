% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_ability.R
\name{estimate_ability}
\alias{estimate_ability}
\title{Estimate Ability Using TAM Framework}
\usage{
estimate_ability(rv, item_bank, config)
}
\arguments{
\item{rv}{Reactive values object containing current assessment state. Required components:
\describe{
  \item{responses}{Numeric vector of item responses in administration order}
  \item{administered}{Integer vector of administered item indices from item bank}
  \item{current_ability}{Current ability estimate (updated by this function)}
  \item{ability_se}{Standard error of current ability estimate}
  \item{ability_history}{Vector tracking ability estimates across items}
}}

\item{item_bank}{Data frame containing item parameters compatible with TAM. 
Required columns vary by model:
\describe{
  \item{Question}{Item content or identifier}
  \item{a}{Discrimination parameter (2PL, 3PL, GRM)}
  \item{b, b1, b2, ...}{Difficulty/threshold parameters}
  \item{c}{Guessing parameter (3PL only)}
  \item{ResponseCategories}{Response scale definition (GRM)}
}}

\item{config}{Study configuration object created by \code{\link{create_study_config}}.
Critical elements:
\describe{
  \item{model}{IRT model specification for TAM}
  \item{estimation_method}{TAM estimation procedure}
  \item{theta_prior}{Prior distribution parameters}
  \item{theta_grid}{Numerical integration grid}
}}
}
\value{
Named list containing ability estimation results:
\describe{
  \item{theta}{Ability estimate on logit scale}
  \item{se}{Standard error of ability estimate}
  \item{method}{Estimation method used ("TAM", "EAP", "WLE", "MIRT")}
  \item{convergence}{Logical indicating estimation convergence}
  \item{posterior}{Posterior distribution (EAP method)}
  \item{likelihood}{Likelihood function values (WLE method)}
  \item{info}{Fisher information at ability estimate}
  \item{reliability}{Empirical reliability estimate}
  \item{fit_statistics}{Model fit indicators when available}
}
}
\description{
Estimates person ability using Item Response Theory models through the TAM package.
This function serves as an interface layer that passes response data to TAM's validated 
psychometric functions and returns standardized results for the \code{inrep} workflow.
All statistical computations are performed exclusively by TAM (Robitzsch et al., 2020).
}
\details{
\strong{TAM Integration Architecture:} This function implements a comprehensive interface
to TAM's ability estimation procedures without implementing independent psychometric algorithms.
The integration follows established IRT best practices:

\strong{Model-Specific TAM Functions:}
\describe{
  \item{\strong{1PL/Rasch Model}}{
    Uses \code{\link[TAM]{tam.mml}} with Rasch constraints (all discriminations = 1).
    Ability estimation via \code{\link[TAM]{tam.wle}} or \code{\link[TAM]{tam.eap}}.
  }
  \item{\strong{2PL Model}}{
    Uses \code{\link[TAM]{tam.mml.2pl}} with item-specific discrimination parameters.
    Supports both WLE and EAP estimation methods.
  }
  \item{\strong{3PL Model}}{
    Uses \code{\link[TAM]{tam.mml.3pl}} including guessing parameters.
    Typically uses EAP estimation due to complexity.
  }
  \item{\strong{GRM (Graded Response Model)}}{
    Uses \code{\link[TAM]{tam.mml}} with polytomous item specifications.
    Handles ordered categorical responses with multiple thresholds.
  }
}

\strong{Estimation Method Selection:}
\describe{
  \item{\strong{TAM (Default)}}{
    Full TAM model estimation with maximum likelihood procedures.
    Provides most accurate estimates but computationally intensive.
  }
  \item{\strong{EAP (Expected A Posteriori)}}{
    Bayesian estimation using \code{\link[TAM]{tam.eap}}.
    Incorporates prior distribution, stable for extreme scores.
  }
  \item{\strong{WLE (Weighted Likelihood)}}{
    Frequentist estimation using \code{\link[TAM]{tam.wle}}.
    Reduces bias compared to maximum likelihood.
  }
  \item{\strong{MIRT (Compatibility)}}{
    Alternative estimation using \code{mirt} package when specified.
    Provides cross-validation of TAM results.
  }
}

\strong{Adaptive Integration:} In adaptive testing contexts:
\itemize{
  \item Updates ability estimate after each item administration
  \item Maintains ability history for tracking convergence
  \item Provides real-time standard error monitoring
  \item Supports stopping rule evaluation based on precision
}

\strong{Quality Control and Robustness:}
\itemize{
  \item Automatic fallback to EAP if TAM estimation fails to converge
  \item Uses prior mean when insufficient response data available
  \item Validates theta_grid specifications for numerical stability
  \item Handles edge cases (all correct/incorrect responses) gracefully
  \item Provides convergence diagnostics and warnings
}

\strong{Performance Optimization:}
\itemize{
  \item Caches item parameters and information calculations
  \item Utilizes parallel processing when enabled in configuration
  \item Implements incremental estimation updates in adaptive mode
  \item Minimizes redundant TAM function calls through intelligent caching
}

\strong{Error Handling:} Comprehensive error management includes:
\itemize{
  \item Graceful handling of TAM estimation failures
  \item Automatic model specification validation
  \item Response pattern analysis for unusual cases
  \item Logging of estimation issues for debugging
}

All psychometric computations rely exclusively on TAM's peer-reviewed implementations.
\code{inrep} provides the data management, workflow integration, and user interface layers.
}
\examples{
\dontrun{
# Example 1: Basic Ability Estimation with GRM
library(inrep)
data(bfi_items)

# Create study configuration
config <- create_study_config(
  model = "GRM", 
  estimation_method = "TAM",
  theta_prior = c(0, 1)
)

# Simulate response data
rv <- list(
  responses = c(2, 4, 3, 1, 5),
  administered = c(1, 5, 12, 18, 23),
  current_ability = 0,
  ability_se = 1,
  ability_history = c()
)

# Estimate ability using TAM
result <- estimate_ability(rv, bfi_items, config)

# Display results
cat("Ability Estimate:", round(result$theta, 3), "\n")
cat("Standard Error:", round(result$se, 3), "\n")
cat("Estimation Method:", result$method, "\n")
cat("Convergence:", result$convergence, "\n")

# Example 2: 2PL Model with WLE Estimation
config_2pl <- create_study_config(
  model = "2PL",
  estimation_method = "WLE",
  theta_prior = c(0, 1.2)
)

# Cognitive test item bank
cognitive_items <- data.frame(
  Question = c("Item 1", "Item 2", "Item 3", "Item 4", "Item 5"),
  a = c(1.2, 0.8, 1.5, 1.0, 1.3),
  b = c(-0.5, 0.2, -1.0, 0.8, -0.3),
  Option1 = c("A", "A", "A", "A", "A"),
  Option2 = c("B", "B", "B", "B", "B"),
  Option3 = c("C", "C", "C", "C", "C"),
  Option4 = c("D", "D", "D", "D", "D"),
  Answer = c("B", "C", "A", "D", "B")
)

# Response data (0 = incorrect, 1 = correct)
rv_2pl <- list(
  responses = c(1, 0, 1, 1, 0),
  administered = c(1, 2, 3, 4, 5),
  current_ability = 0,
  ability_se = 1,
  ability_history = c()
)

# Estimate ability
result_2pl <- estimate_ability(rv_2pl, cognitive_items, config_2pl)

# Compare different estimation methods
cat("2PL WLE Estimate:", round(result_2pl$theta, 3), "\n")
cat("Information at estimate:", round(result_2pl$info, 3), "\n")

# Example 3: EAP Estimation with Custom Prior
config_eap <- create_study_config(
  model = "GRM",
  estimation_method = "EAP",
  theta_prior = c(0.5, 0.8),  # Shifted prior for specific population
  theta_grid = seq(-4, 4, 0.1)  # Fine grid for precision
)

# Estimate with EAP
result_eap <- estimate_ability(rv, bfi_items, config_eap)

# View posterior distribution
if (!is.null(result_eap$posterior)) {
  cat("EAP Estimate:", round(result_eap$theta, 3), "\n")
  cat("Posterior SD:", round(result_eap$se, 3), "\n")
  cat("Reliability:", round(result_eap$reliability, 3), "\n")
}

# Example 4: Adaptive Testing Context
# Simulate adaptive testing scenario
simulate_adaptive_estimation <- function(true_theta, item_bank, config) {
  rv <- list(
    responses = c(),
    administered = c(),
    current_ability = 0,
    ability_se = 1,
    ability_history = c()
  )
  
  # Simulate 10 items
  for (i in 1:10) {
    # Simulate item selection (simplified)
    item_idx <- sample(1:nrow(item_bank), 1)
    
    # Simulate response based on true theta
    prob_correct <- plogis(true_theta - item_bank$b[item_idx])
    response <- rbinom(1, 1, prob_correct)
    
    # Update response data
    rv$responses <- c(rv$responses, response)
    rv$administered <- c(rv$administered, item_idx)
    
    # Estimate ability
    result <- estimate_ability(rv, item_bank, config)
    
    # Update tracking
    rv$current_ability <- result$theta
    rv$ability_se <- result$se
    rv$ability_history <- c(rv$ability_history, result$theta)
    
    cat(sprintf("Item \%d: Response = \%d, Theta = \%.3f, SE = \%.3f\n", 
                i, response, result$theta, result$se))
  }
  
  return(list(
    final_theta = rv$current_ability,
    final_se = rv$ability_se,
    history = rv$ability_history,
    true_theta = true_theta,
    bias = rv$current_ability - true_theta
  ))
}

# Run adaptive simulation
adaptive_config <- create_study_config(
  model = "1PL",
  estimation_method = "EAP"
)

# Simple 1PL item bank
rasch_items <- data.frame(
  Question = paste("Item", 1:20),
  b = seq(-2, 2, length.out = 20),
  Option1 = rep("A", 20),
  Option2 = rep("B", 20),
  Answer = rep("B", 20)
)

sim_result <- simulate_adaptive_estimation(
  true_theta = 0.5, 
  item_bank = rasch_items, 
  config = adaptive_config
)

cat("\nAdaptive Testing Summary:\n")
cat("True Theta:", sim_result$true_theta, "\n")
cat("Final Estimate:", round(sim_result$final_theta, 3), "\n")
cat("Final SE:", round(sim_result$final_se, 3), "\n")
cat("Bias:", round(sim_result$bias, 3), "\n")

# Example 5: Model Comparison
# Compare estimation methods for same data
methods <- c("TAM", "EAP", "WLE")
comparison_results <- list()

for (method in methods) {
  method_config <- create_study_config(
    model = "2PL",
    estimation_method = method
  )
  
  result <- estimate_ability(rv_2pl, cognitive_items, method_config)
  comparison_results[[method]] <- result
}

# Display comparison
cat("\nMethod Comparison:\n")
for (method in methods) {
  result <- comparison_results[[method]]
  cat(sprintf("\%s: Theta = \%.3f, SE = \%.3f\n", 
              method, result$theta, result$se))
}
}

}
\references{
\itemize{
  \item Robitzsch, A., Kiefer, T., & Wu, M. (2020). \emph{TAM: Test Analysis Modules}. 
    R package version 3.5-19. \url{https://CRAN.R-project.org/package=TAM}
  \item Warm, T. A. (1989). Weighted likelihood estimation of ability in item response theory. 
    \emph{Psychometrika}, 54(3), 427-450.
  \item Bock, R. D., & Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. 
    \emph{Applied Psychological Measurement}, 6(4), 431-444.
  \item Baker, F. B., & Kim, S. H. (2004). \emph{Item response theory: Parameter estimation techniques}. 
    CRC Press.
  \item Embretson, S. E., & Reise, S. P. (2000). \emph{Item response theory for psychologists}. 
    Lawrence Erlbaum Associates.
}

Robitzsch A, Kiefer T, Wu M (2024). TAM: Test Analysis Modules. R package version 4.2-21, https://CRAN.R-project.org/package=TAMst Analysis Modules. 
R package version 3.5-19. \url{https://CRAN.R-project.org/package=TAM}

Robitzsch, A., Kiefer, T., George, A. C., & Uenlue, A. (2020). 
CDM: Cognitive Diagnosis Modeling. R package version 7.5-15.
}
\seealso{
\itemize{
  \item \code{\link{create_study_config}} for configuring estimation parameters
  \item \code{\link{select_next_item}} for adaptive item selection using ability estimates
  \item \code{\link{launch_study}} for complete assessment implementation
  \item \code{\link[TAM]{tam.wle}} for WLE estimation details
  \item \code{\link[TAM]{tam.eap}} for EAP estimation details
}

\code{\link{create_study_config}}, \code{\link{select_next_item}}, 
  \code{\link{launch_study}}
}
\keyword{IRT}
\keyword{ability}
\keyword{estimation}
\keyword{psychometrics}
